<div class="app-container" id="${properties.productType}">
  <div class="product-container">
    <div class="iframe-container hidden"></div>
    <div class="image-detail-container">
      <div class="image-section">
        <div id="top-image-section">
          <img src="${properties.productimage1}" id="top_image" alt="black" class="image" loading="eager" />
        </div>
      </div>
      <div class="image-section">
        <div id="bottom-image-section">
          <img src="${properties.productimage2}" id="bottom_image_1" alt="black" class="image" />
          <img src="${properties.productimage3}" id="bottom_image_2" alt="gray" class="image" />
        </div>
      </div>
    </div>
    <div class="details-section flex-column">
      <div class="details-section__description flex-column">
        <div class="details-section__description--heading">${properties.productTitle}</div>
        <div class="details-section__description--price">${properties.productPrice}</div>
        <div class="details-section__description--subHeading">${properties.productDescription}</div>
        <div class="details-section__description--text">${properties.productDetailsDescription}</div>
      </div>
      <sly data-sly-test="${properties.genderOptions == 'true'}">
        <div class="details-section__toggle-section">
          <div class="toggle-slider">
            <div class="toggle-option" id="women-toggle">WOMEN'S</div>
            <div class="toggle-option" id="men-toggle">MEN'S</div>
            <div class="toggle-indicator"></div>
          </div>
        </div>
      </sly>
      <sly data-sly-test="${properties.colorOptions == 'true'}">
        <div class="details-section__color-selector">
          <div class="inner-div">
            <span> COLORS</span>
          </div>
          <div class="color-options" id="color-options">
            <div class="color-item colorActive" id="blue">
              <img src="${properties.productcolor1}" alt="Blue" />
            </div>
            <div class="color-item" id="gray">
              <img src="${properties.productcolor2}" alt="Gray" />
            </div>
            <div class="color-item" id="orange">
              <img src="${properties.productcolor3}" alt="Orange" />
            </div>
            <div class="color-item" id="white">
              <img src="${properties.productcolor4}" alt="White" />
            </div>
          </div>
        </div>
      </sly>
      <div class="details-section__size-selector">
        <div class="select-size-heading">
          <div class="inner-div">
            <span> SIZES </span>
          </div>
          <sly data-sly-test="${properties.sizeOptions == 'true'}">
            <div class="size-options allsizes" id="all-sizes"></div>
          </sly>
          <sly data-sly-test="${properties.sizeOptions != 'true'}">
            <div class="size-options one-size" id="one-size">
              <button class="size-button selected one-size">One-size fits all</button>
            </div>
          </sly>
        </div>
      </div>
      <div class="details-section__shipping">
        <button class="details-section__shipping--button add-to-bag">
          <span>Add To Bag</span>
          <span>
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16" fill="none">
              <path d="M5.85237 1.33398C4.54583 1.33398 3.48194 2.3365 3.48194 3.58868V4.29696H1.85235C1.8477 4.29675 1.84305 4.29675 1.8384 4.29696C1.7671 4.30337 1.71057 4.3599 1.70416 4.4312L0.667147 13.9127C0.666941 13.9173 0.666941 13.9219 0.667147 13.9266C0.667147 14.3339 1.00053 14.6673 1.40789 14.6673H10.2968C10.7042 14.6673 11.0376 14.3339 11.0376 13.9266C11.0378 13.9219 11.0378 13.9173 11.0376 13.9127L10.0005 4.4312C9.99331 4.35483 9.92904 4.29665 9.85236 4.29696H8.22277V3.58868C8.22277 2.3365 7.15891 1.33398 5.85237 1.33398ZM5.85237 1.63026C7.00804 1.63026 7.9264 2.50399 7.9264 3.58865V4.29693H3.77823V3.58865C3.77823 2.50399 4.69673 1.63026 5.85237 1.63026ZM1.98674 4.59323H3.48207V5.18588C3.48155 5.22546 3.49342 5.26012 3.52475 5.29191C3.55611 5.32373 3.63026 5.33614 3.63026 5.33614C3.63026 5.33614 3.70441 5.32373 3.73577 5.29191C3.7671 5.26012 3.77897 5.22546 3.77845 5.18588V4.59323H7.92662V5.33398C7.9261 5.37366 7.9415 5.4119 7.9693 5.44011C7.9971 5.46832 8.03513 5.48423 8.07481 5.48423C8.11449 5.48423 8.15252 5.46832 8.18032 5.44011C8.20812 5.4119 8.22352 5.37366 8.223 5.33398V4.59323H9.71832L10.7415 13.9266V13.9313C10.739 14.1763 10.5427 14.3711 10.297 14.3711H1.4081C1.16246 14.3711 0.966115 14.1763 0.963628 13.9313V13.9266L1.98674 4.59323Z" stroke="white" stroke-width="0.933333" />
            </svg>
          </span>
        </button>
        <button class="details-section__shipping--button try-on" onclick="loadiFrameModal()">
          <span>TRY ON WITH AI </span>
          <span>
            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="17" viewBox="0 0 21 17" fill="none">
              <path d="M11.3633 1.36523L13.1558 6.20944L18 8.00195L13.1558 9.79447L11.3633 14.6387L9.57076 9.79447L4.72656 8.00195L9.57076 6.20944L11.3633 1.36523Z" fill="#28455C" />
              <path d="M5.62109 10.2188L6.32903 12.1319L8.24219 12.8398L6.32903 13.5478L5.62109 15.4609L4.91316 13.5478L3 12.8398L4.91316 12.1319L5.62109 10.2188Z" fill="#28455C" />
              <path d="M6.33047 2.21875L6.68982 3.18987L7.66094 3.54922L6.68982 3.90857L6.33047 4.87969L5.97112 3.90857L5 3.54922L5.97112 3.18987L6.33047 2.21875Z" fill="#28455C" />
            </svg>
          </span>
        </button>
      </div>
      <div class="details-section__sustainability-info">${properties.productMade}</div>
    </div>
  </div>
</div>
<script>
  const colors = ["rgb(0 0 0)", "rgb(255 255 255)", "rgb(200 200 200)"];
  const sizes = ["XS", "S", "M", "L", "XL", "XXL", "3XL"];
  const images = {
    orange:{
      "top_image":"orange/product-1.png",
      "bottom_image_1":"orange/product-2.png",
      "bottom_image_2":"orange/product-3.png",
    },
    blue:{
    "top_image":"blue/product-1.png",
    "bottom_image_1":"blue/product-2.png",
    "bottom_image_2":"blue/product-3.png",
    },
    gray:{
      "top_image":"gray/product-1.png",
      "bottom_image_1":"gray/product-2.png",
      "bottom_image_2":"gray/product-3.png",
    },
    white:{
      "top_image":"white/product-1.png",
      "bottom_image_1":"white/product-2.png",
      "bottom_image_2":"white/product-3.png",
    }
  }
  let selectedSize = "M";
  const colorOptions = document.querySelectorAll(".color-item");
  const sizeOptions = document.getElementById("all-sizes");
  const toggleSlider = document.querySelector('.toggle-slider');
  const toggleOptions = document.querySelectorAll('.toggle-option');
  const toggleIndicator = document.querySelector('.toggle-indicator');
  const rootContainer = document.querySelector(".app-container");
  const iframeContainer = document.querySelector('.iframe-container');

  toggleSlider.addEventListener('click', (e) => {
    const clickedOption = e.target;
    if (clickedOption.id === 'women-toggle') {
      toggleIndicator.style.left = '2px';
      toggleOptions[0].classList.add('active');
      toggleOptions[1].classList.remove('active');
    } else if (clickedOption.id === 'men-toggle') {
      toggleIndicator.style.left = 'calc(50% + 2px)';
      toggleOptions[1].classList.add('active');
      toggleOptions[0].classList.remove('active');
    }
  });

  function updateImageBackground(key) {
    const prefixPath = '/content/dam/venia/sites/products';
    const currentProduct = rootContainer.getAttribute("id").split("-")[1]; //hoodie or hat or jersey
    const top_image = document.querySelector("#top_image");
    const bottom_image_1 = document.querySelector("#bottom_image_1");
    const bottom_image_2 = document.querySelector("#bottom_image_2");
    top_image.src = ""+ prefixPath + "/" + currentProduct + "/" + images[key].top_image;
    bottom_image_1.src = ""+ prefixPath + "/" + currentProduct + "/" + images[key].bottom_image_2;
    bottom_image_2.src = ""+ prefixPath + "/" + currentProduct + "/" + images[key].bottom_image_1;
  }
  colorOptions.forEach((color, index) => {
    color.addEventListener("click", () => {
      if(iframeContainer.childNodes.length > 0){
        iframeContainer.removeChild(iframeContainer.firstChild);
        iframeContainer.classList.add('hidden');
      }
      colorOptions.forEach(box => box.classList.remove('colorActive'));
      color.classList.add("colorActive");
      const currentColor =  color.id;
      updateImageBackground(currentColor);
    });
  });
  sizes.forEach(size => {
    const sizeButton = document.createElement("button");
    sizeButton.className = "size-button";
    sizeButton.textContent = size;
    if (size === selectedSize) sizeButton.classList.add("selected");
    sizeButton.addEventListener("click", () => {
      selectedSize = size;
      document.querySelectorAll(".size-button").forEach(button => button.classList.remove("selected"));
      sizeButton.classList.add("selected");
    });
    sizeOptions.appendChild(sizeButton);
  });
 
  //toggle mens slider on hoodie page;
  if(rootContainer.getAttribute("id").includes('hood')){
    document.querySelector('#men-toggle').click();
    colorOptions.forEach(box => box.classList.remove('colorActive'));
    document.querySelector("#orange").click();
  }else{
    document.querySelector("#blue").click();
  }

  function loadiFrameModal(){
    const iframe = document.createElement('iframe');
    iframe.src = 'https://kiksar-vto-dev.s3.amazonaws.com/code%26theory/index.html#/ConfigModule/client_Viewer';
    iframe.style.width = '100%';
    iframe.style.height = '100%';
    iframeContainer.appendChild(iframe);
    iframeContainer.classList.remove('hidden');
  }
</script>